#executed by a levelEntry armor_stand
#with $(level_id) = this armor stand's UID
#with $(act) = the act we're editing

#get players on the right page
scoreboard players set @a[tag=tellMe] levelManagerPage 3


#armor_stand should update itself on what scores it should have
execute store result storage phan:level_index level_id int 1 run scoreboard players get @s levelUID
function phan:level_manager/panel/score_attack/act/load_data_from_storage with storage phan:level_index


#title (+ act name)
tellraw @a[tag=tellMe] ["",{"text":"\n\n\n\n\n\n\n"}]
$tellraw @a[tag=tellMe] ["",{"text":"===\\/=== ","bold":true,"color":"yellow"},{"selector":"@s"},{"text":" | "},{"nbt":"act_name","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":" ===\\/===","bold":true,"color":"yellow"}]

#playable y/n
#..nah, we're just gonna require that all 3 acts are playable
#$execute if entity @s[tag=act$(act)SelectableSA] run tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.playable","bold":true},{"text":"  "},{"translate":"gp.misc.brackets","color":"yellow","bold":false,"with":[{"translate":"gp.misc.yes"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'playable',value:1}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.yes"}]}},{"text":" "},{"translate":"gp.misc.brackets","color":"gray","bold":false,"with":[{"translate":"gp.misc.no"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'playable',value:0}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.no"}]}}]
#$execute if entity @s[tag=!act$(act)SelectableSA] run tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.playable","bold":true},{"text":"  "},{"translate":"gp.misc.brackets","color":"gray","bold":false,"with":[{"translate":"gp.misc.yes"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'playable',value:1}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.yes"}]}},{"text":" "},{"translate":"gp.misc.brackets","color":"yellow","bold":false,"with":[{"translate":"gp.misc.no"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'playable',value:0}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.no"}]}}]
#act_name
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.act_name","bold":true},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field {resource_location:'sa_act_$(act)',nbt:'act_name',value:'Act $(act)'}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set_with_tip","with":[{"translate":"gp.level_manager.replace_act_x"}]}]}},{"text":"  "},{"nbt":"act_name","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false}]
#pearls_needed
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.pearls_needed","bold":true},{"text":"  "},{"nbt":"pearls_needed","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'pearls_needed',value:16}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]
#time_limit
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.time_limit","bold":true},{"text":"  "},{"nbt":"time_limit","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":" seconds"},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'time_limit',value:120}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]
#target_time
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.target_time","bold":true},{"text":"  "},{"text":"[","color":"white"},{"nbt":"target_time[0]","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false,"color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'target_time[0]',offset:0,mod:21}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.level_manager.click_to_cycle"}]}},{"text":":"},{"nbt":"target_time[1]","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false,"color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'target_time[1]',offset:0,mod:6}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.level_manager.click_to_cycle"}]}},{"nbt":"target_time[2]","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false,"color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'target_time[2]',offset:0,mod:10}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.level_manager.click_to_cycle"}]}},{"text":"]","color":"white"}]
#teleport_dimension (#dimensionSA)
$execute if score #dimensionSA value matches 1 run tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.teleport_dimension","bold":true},{"text":"  "},{"text":"[<]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field_down {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.previous"}]}},{"text":" "},{"text":"[>]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.next"}]}},{"text":"  "},{"translate":"gp.level_manager.dimension_overworld"}]
$execute if score #dimensionSA value matches 2 run tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.teleport_dimension","bold":true},{"text":"  "},{"text":"[<]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field_down {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.previous"}]}},{"text":" "},{"text":"[>]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.next"}]}},{"text":"  "},{"translate":"gp.level_manager.dimension_nether"}]
$execute if score #dimensionSA value matches 3 run tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.teleport_dimension","bold":true},{"text":"  "},{"text":"[<]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field_down {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.previous"}]}},{"text":" "},{"text":"[>]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/cycle_field {resource_location:'sa_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.next"}]}},{"text":"  "},{"translate":"gp.level_manager.dimension_end"}]
#teleport_location
#$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.teleport_coordinates","bold":true},{"text":"  "},{"nbt":"teleport_location","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false,"color":"yellow","bold":false,"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_coordinates {resource_location:'sa_act_$(act)',nbt:'teleport_location',x:0,y:100,z:0}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set_with_tip","with":[{"translate":"gp.level_manager.replace_xyz"}]}]}}]
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.teleport_coordinates","bold":true},{"text":"  "},{"score":{"name":"#coord_x","objective":"value"}},{"text":" "},{"score":{"name":"#coord_y","objective":"value"}},{"text":" "},{"score":{"name":"#coord_z","objective":"value"}},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_coordinates {resource_location:'sa_act_$(act)',nbt:'teleport_location',x:0,y:100,z:0}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set_with_tip","with":[{"translate":"gp.level_manager.replace_xyz"}]}]}},{"text":"  "},{"translate":"gp.misc.brackets","color":"dark_aqua","with":[{"translate":"gp.level_manager.warp_to"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/warp_to_act {mode:'sa',act:'$(act)'}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.level_manager.warp_to"}]}}]
#score_requirement_c
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.rank_point_requirement","bold":true,"with":[{"text":"C"}]},{"text":"  "},{"nbt":"score_requirement_c","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'score_requirement_c',value:10000}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]
#score_requirement_b
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.rank_point_requirement","bold":true,"with":[{"text":"B"}]},{"text":"  "},{"nbt":"score_requirement_b","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'score_requirement_b',value:25000}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]
#score_requirement_a
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.rank_point_requirement","bold":true,"with":[{"text":"A"}]},{"text":"  "},{"nbt":"score_requirement_a","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'score_requirement_a',value:50000}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]
#score_requirement_s
$tellraw @a[tag=tellMe] ["",{"translate":"gp.level_manager.rank_point_requirement","bold":true,"with":[{"text":"S"}]},{"text":"  "},{"nbt":"score_requirement_s","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":"  "},{"translate":"gp.misc.brackets","color":"light_purple","bold":false,"with":[{"translate":"gp.misc.set"}],"clickEvent":{"action":"suggest_command","value":"/function phan:level_manager/set_field_numeric {resource_location:'sa_act_$(act)',nbt:'score_requirement_s',value:75000}"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.set"}]}}]

#page number
tellraw @a[tag=tellMe] ["",{"text":" "},{"translate":"gp.level_manager.page_x_of_x","with":[{"text":"1"},{"text":"2"}],"italic":true},{"text":"  "},{"text":"[<<]","color":"dark_gray","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/error_noise"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.previous"}]}},{"text":" "},{"text":"[>>]","color":"yellow","bold":false,"clickEvent":{"action":"run_command","value":"/function phan:level_manager/panel/score_attack/act/_menu_2_lookup"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.next"}]}}]

#back button
tellraw @a[tag=tellMe] ["",{"text":" "}]
tellraw @a[tag=tellMe] ["",{"translate":"gp.misc.brackets","color":"red","bold":false,"with":[{"translate":"gp.misc.back"}],"clickEvent":{"action":"run_command","value":"/function phan:level_manager/panel/score_attack/_menu_lookup"},"hoverEvent":{"action":"show_text","value":[{"translate":"gp.misc.back"}]}}]

$tellraw @a[tag=tellMe] ["",{"text":"===/\\=== ","bold":true,"color":"yellow"},{"selector":"@s"},{"text":" | "},{"nbt":"act_name","storage":"phan_dream_$(level_id):sa_act_$(act)","interpret":false},{"text":" ===/\\===","bold":true,"color":"yellow"}]