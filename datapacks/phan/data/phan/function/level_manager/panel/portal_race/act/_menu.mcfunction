#executed by a levelEntry armor_stand
#with $(level_id) = this armor stand's UID
#with $(act) = the act we're editing

#get players on the right page
scoreboard players set @a[tag=tellMe] levelManagerPage 6


#armor_stand should update itself on what scores it should have
execute store result storage phan:level_index level_id int 1 run scoreboard players get @s levelUID
function phan:level_manager/panel/portal_race/act/load_data_from_storage with storage phan:level_index


#title (+ act name)
tellraw @a[tag=tellMe] ["",{text:"\n\n\n\n\n\n\n"}]
$tellraw @a[tag=tellMe] ["",{text:"===\\/=== ",bold:true,color:"light_purple"},{selector:"@s"},{text:" | "},{nbt:"act_name",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:" ===\\/===",bold:true,color:"light_purple"}]

#playable y/n
$execute if entity @s[tag=act$(act)SelectablePR] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.playable",bold:true},{text:"  "},{translate:"gp.misc.brackets",color:"yellow",bold:false,with:[{translate:"gp.misc.yes"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'playable',value:1}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.yes"}]}},{text:" "},{translate:"gp.misc.brackets",color:"gray",bold:false,with:[{translate:"gp.misc.no"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'playable',value:0}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.no"}]}}]
$execute if entity @s[tag=!act$(act)SelectablePR] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.playable",bold:true},{text:"  "},{translate:"gp.misc.brackets",color:"gray",bold:false,with:[{translate:"gp.misc.yes"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'playable',value:1}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.yes"}]}},{text:" "},{translate:"gp.misc.brackets",color:"yellow",bold:false,with:[{translate:"gp.misc.no"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'playable',value:0}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.no"}]}}]
#act_name
$tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.act_name",bold:true},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field {resource_location:'pr_act_$(act)',nbt:'act_name',value:'Act $(act)'}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set_with_tip",with:[{translate:"gp.level_manager.replace_act_x"}]}]}},{text:"  "},{nbt:"act_name",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false}]
#game_type
$execute if entity @s[tag=!act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.game_type",bold:true},{text:"  "},{text:"[<]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field_down {resource_location:'pr_act_$(act)',nbt:'game_type',offset:1,mod:2}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field {resource_location:'pr_act_$(act)',nbt:'game_type',offset:1,mod:2}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}},{text:"  "},{translate:"gp.level_manager.race"}]
$execute if entity @s[tag=act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.game_type",bold:true},{text:"  "},{text:"[<]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field_down {resource_location:'pr_act_$(act)',nbt:'game_type',offset:1,mod:2}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field {resource_location:'pr_act_$(act)',nbt:'game_type',offset:1,mod:2}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}},{text:"  "},{translate:"gp.level_manager.battle"}]
#checkpoints
$execute if entity @s[tag=!act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.checkpoints_per_lap",bold:true},{text:"  "},{nbt:"checkpoints",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'checkpoints',value:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set"}]}}]
$execute if entity @s[tag=act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.checkpoints_per_lap",bold:true,color:"dark_gray"},{text:"  "},{nbt:"checkpoints",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false,color:"dark_gray"}]
#laps
$execute if entity @s[tag=!act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.laps",bold:true},{text:"  "},{nbt:"laps",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'laps',value:4}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set"}]}}]
$execute if entity @s[tag=act$(act)BattleMode] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.laps",bold:true,color:"dark_gray"},{text:"  "},{nbt:"laps",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false,color:"dark_gray"}]
#pearls_needed
$tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.pearls_needed",bold:true},{text:"  "},{nbt:"pearls_needed",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'pearls_needed',value:16}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set"}]}}]
#supports bots
$execute if entity @s[tag=act$(act)SupportsBots] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.supports_bots",bold:true},{text:"  "},{translate:"gp.misc.brackets",color:"yellow",bold:false,with:[{translate:"gp.misc.yes"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'supports_bots',value:1}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.yes"}]}},{text:" "},{translate:"gp.misc.brackets",color:"gray",bold:false,with:[{translate:"gp.misc.no"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'supports_bots',value:0}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.no"}]}}]
$execute if entity @s[tag=!act$(act)SupportsBots] run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.supports_bots",bold:true},{text:"  "},{translate:"gp.misc.brackets",color:"gray",bold:false,with:[{translate:"gp.misc.yes"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'supports_bots',value:1}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.yes"}]}},{text:" "},{translate:"gp.misc.brackets",color:"yellow",bold:false,with:[{translate:"gp.misc.no"}],click_event:{action:"run_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'supports_bots',value:0}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.no"}]}}]
#time_limit
$tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.time_limit",bold:true},{text:"  "},{nbt:"time_limit",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:" minutes"},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'time_limit',value:5}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set"}]}}]
#time_limit_minimum
$tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.minimum_time_limit",bold:true},{text:"  "},{nbt:"time_limit_minimum",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:" minutes"},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_field_numeric {resource_location:'pr_act_$(act)',nbt:'time_limit_minimum',value:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set"}]}}]
#teleport_dimension (#dimensionPR)
$execute if score #dimensionPR value matches 1 run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.teleport_dimension",bold:true},{text:"  "},{text:"[<]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field_down {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}},{text:"  "},{translate:"gp.level_manager.dimension_overworld"}]
$execute if score #dimensionPR value matches 2 run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.teleport_dimension",bold:true},{text:"  "},{text:"[<]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field_down {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}},{text:"  "},{translate:"gp.level_manager.dimension_nether"}]
$execute if score #dimensionPR value matches 3 run tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.teleport_dimension",bold:true},{text:"  "},{text:"[<]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field_down {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/cycle_field {resource_location:'pr_act_$(act)',nbt:'teleport_dimension',offset:1,mod:3}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}},{text:"  "},{translate:"gp.level_manager.dimension_end"}]
#teleport_location
$tellraw @a[tag=tellMe] ["",{translate:"gp.level_manager.teleport_coordinates",bold:true},{text:"  "},{score:{name:"#coord_x",objective:"value"}},{text:" "},{score:{name:"#coord_y",objective:"value"}},{text:" "},{score:{name:"#coord_z",objective:"value"}},{text:"  "},{translate:"gp.misc.brackets",color:"light_purple",bold:false,with:[{translate:"gp.misc.set"}],click_event:{action:"suggest_command",command:"/function phan:level_manager/set_coordinates {resource_location:'pr_act_$(act)',nbt:'teleport_location',x:0,y:100,z:0}"},hover_event:{action:"show_text",value:[{translate:"gp.misc.set_with_tip",with:[{translate:"gp.level_manager.replace_xyz"}]}]}},{text:"  "},{translate:"gp.misc.brackets",color:"dark_aqua",with:[{translate:"gp.level_manager.warp_to"}],click_event:{action:"run_command",command:"/function phan:level_manager/warp_to_act {mode:'pr',act:'$(act)'}"},hover_event:{action:"show_text",value:[{translate:"gp.level_manager.warp_to"}]}}]

#page number
tellraw @a[tag=tellMe] ["",{text:" "},{translate:"gp.level_manager.page_x_of_x",with:[{text:"1"},{text:"3"}],italic:true},{text:"  "},{text:"[<<]",color:"dark_gray",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/error_noise"},hover_event:{action:"show_text",value:[{translate:"gp.misc.previous"}]}},{text:" "},{text:"[>>]",color:"yellow",bold:false,click_event:{action:"run_command",command:"/function phan:level_manager/panel/portal_race/act/_menu_2_lookup"},hover_event:{action:"show_text",value:[{translate:"gp.misc.next"}]}}]

#back button
tellraw @a[tag=tellMe] ["",{text:" "}]
tellraw @a[tag=tellMe] ["",{translate:"gp.misc.brackets",color:"red",bold:false,with:[{translate:"gp.misc.back"}],click_event:{action:"run_command",command:"/function phan:level_manager/panel/portal_race/_menu_lookup"},hover_event:{action:"show_text",value:[{translate:"gp.misc.back"}]}}]

$tellraw @a[tag=tellMe] ["",{text:"===/\\=== ",bold:true,color:"light_purple"},{selector:"@s"},{text:" | "},{nbt:"act_name",storage:"phan_dream_$(level_id):pr_act_$(act)",interpret:false},{text:" ===/\\===",bold:true,color:"light_purple"}]